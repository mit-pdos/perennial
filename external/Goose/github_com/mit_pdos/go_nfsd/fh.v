(* autogenerated from github.com/mit-pdos/go-nfsd/fh *)
From Perennial.goose_lang Require Import prelude.
From Perennial.goose_lang Require Import ffi.disk_prelude.

From Goose Require github_com.goose_lang.std.
From Goose Require github_com.mit_pdos.go_journal.common.
From Goose Require github_com.mit_pdos.go_nfsd.nfstypes.
From Goose Require github_com.tchajed.marshal.

Definition Fh := struct.decl [
  "Ino" :: uint64T;
  "Gen" :: uint64T
].

Definition MakeFh: val :=
  rec: "MakeFh" "fh3" :=
    let: "dec" := marshal.NewDec (struct.get nfstypes.Nfs_fh3 "Data" "fh3") in
    let: "i" := marshal.Dec__GetInt "dec" in
    let: "g" := marshal.Dec__GetInt "dec" in
    struct.mk Fh [
      "Ino" ::= "i";
      "Gen" ::= "g"
    ].

Definition Fh__MakeFh3: val :=
  rec: "Fh__MakeFh3" "fh" :=
    let: "enc" := marshal.NewEnc #16 in
    marshal.Enc__PutInt "enc" (struct.get Fh "Ino" "fh");;
    marshal.Enc__PutInt "enc" (struct.get Fh "Gen" "fh");;
    let: "fh3" := struct.mk nfstypes.Nfs_fh3 [
      "Data" ::= marshal.Enc__Finish "enc"
    ] in
    "fh3".

Definition MkRootFh3: val :=
  rec: "MkRootFh3" <> :=
    let: "enc" := marshal.NewEnc #16 in
    marshal.Enc__PutInt "enc" common.ROOTINUM;;
    marshal.Enc__PutInt "enc" #1;;
    struct.mk nfstypes.Nfs_fh3 [
      "Data" ::= marshal.Enc__Finish "enc"
    ].

Definition Equal: val :=
  rec: "Equal" "h1" "h2" :=
    std.BytesEqual (struct.get nfstypes.Nfs_fh3 "Data" "h1") (struct.get nfstypes.Nfs_fh3 "Data" "h2").
