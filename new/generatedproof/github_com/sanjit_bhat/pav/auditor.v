(* autogenerated by goose proofgen; do not modify *)
Require Export New.proof.proof_prelude.
Require Export New.generatedproof.bytes.
Require Export New.generatedproof.sync.
Require Export New.generatedproof.github_com.goose_lang.std.
Require Export New.generatedproof.github_com.sanjit_bhat.pav.advrpc.
Require Export New.generatedproof.github_com.sanjit_bhat.pav.cryptoffi.
Require Export New.generatedproof.github_com.sanjit_bhat.pav.hashchain.
Require Export New.generatedproof.github_com.sanjit_bhat.pav.ktcore.
Require Export New.generatedproof.github_com.sanjit_bhat.pav.merkle.
Require Export New.generatedproof.github_com.sanjit_bhat.pav.server.
Require Export New.generatedproof.github_com.sanjit_bhat.pav.safemarshal.
Require Export New.generatedproof.github_com.tchajed.marshal.
Require Export New.golang.theory.

Require Export New.code.github_com.sanjit_bhat.pav.auditor.

Set Default Proof Using "Type".

Module auditor.

(* type auditor.Auditor *)
Module Auditor.
Section def.
Context `{ffi_syntax}.
Record t := mk {
  mu' : loc;
  sk' : loc;
  lastDig' : slice.t;
  startEp' : w64;
  hist' : slice.t;
  serv' : loc;
}.
End def.
End Auditor.

Section instances.
Context `{ffi_syntax}.
#[local] Transparent auditor.Auditor.
#[local] Typeclasses Transparent auditor.Auditor.

Global Instance Auditor_wf : struct.Wf auditor.Auditor.
Proof. apply _. Qed.

Global Instance settable_Auditor : Settable Auditor.t :=
  settable! Auditor.mk < Auditor.mu'; Auditor.sk'; Auditor.lastDig'; Auditor.startEp'; Auditor.hist'; Auditor.serv' >.
Global Instance into_val_Auditor : IntoVal Auditor.t :=
  {| to_val_def v :=
    struct.val_aux auditor.Auditor [
    "mu" ::= #(Auditor.mu' v);
    "sk" ::= #(Auditor.sk' v);
    "lastDig" ::= #(Auditor.lastDig' v);
    "startEp" ::= #(Auditor.startEp' v);
    "hist" ::= #(Auditor.hist' v);
    "serv" ::= #(Auditor.serv' v)
    ]%struct
  |}.

Global Program Instance into_val_typed_Auditor : IntoValTyped Auditor.t auditor.Auditor :=
{|
  default_val := Auditor.mk (default_val _) (default_val _) (default_val _) (default_val _) (default_val _) (default_val _);
|}.
Next Obligation. solve_to_val_type. Qed.
Next Obligation. solve_zero_val. Qed.
Next Obligation. solve_to_val_inj. Qed.
Final Obligation. solve_decision. Qed.

Global Instance into_val_struct_field_Auditor_mu : IntoValStructField "mu" auditor.Auditor Auditor.mu'.
Proof. solve_into_val_struct_field. Qed.

Global Instance into_val_struct_field_Auditor_sk : IntoValStructField "sk" auditor.Auditor Auditor.sk'.
Proof. solve_into_val_struct_field. Qed.

Global Instance into_val_struct_field_Auditor_lastDig : IntoValStructField "lastDig" auditor.Auditor Auditor.lastDig'.
Proof. solve_into_val_struct_field. Qed.

Global Instance into_val_struct_field_Auditor_startEp : IntoValStructField "startEp" auditor.Auditor Auditor.startEp'.
Proof. solve_into_val_struct_field. Qed.

Global Instance into_val_struct_field_Auditor_hist : IntoValStructField "hist" auditor.Auditor Auditor.hist'.
Proof. solve_into_val_struct_field. Qed.

Global Instance into_val_struct_field_Auditor_serv : IntoValStructField "serv" auditor.Auditor Auditor.serv'.
Proof. solve_into_val_struct_field. Qed.


Context `{!ffi_model, !ffi_semantics _ _, !ffi_interp _, !heapGS Σ}.
Global Instance wp_struct_make_Auditor mu' sk' lastDig' startEp' hist' serv':
  PureWp True
    (struct.make #auditor.Auditor (alist_val [
      "mu" ::= #mu';
      "sk" ::= #sk';
      "lastDig" ::= #lastDig';
      "startEp" ::= #startEp';
      "hist" ::= #hist';
      "serv" ::= #serv'
    ]))%struct
    #(Auditor.mk mu' sk' lastDig' startEp' hist' serv').
Proof. solve_struct_make_pure_wp. Qed.


Global Instance Auditor_struct_fields_split dq l (v : Auditor.t) :
  StructFieldsSplit dq l v (
    "Hmu" ∷ l ↦s[auditor.Auditor :: "mu"]{dq} v.(Auditor.mu') ∗
    "Hsk" ∷ l ↦s[auditor.Auditor :: "sk"]{dq} v.(Auditor.sk') ∗
    "HlastDig" ∷ l ↦s[auditor.Auditor :: "lastDig"]{dq} v.(Auditor.lastDig') ∗
    "HstartEp" ∷ l ↦s[auditor.Auditor :: "startEp"]{dq} v.(Auditor.startEp') ∗
    "Hhist" ∷ l ↦s[auditor.Auditor :: "hist"]{dq} v.(Auditor.hist') ∗
    "Hserv" ∷ l ↦s[auditor.Auditor :: "serv"]{dq} v.(Auditor.serv')
  ).
Proof.
  rewrite /named.
  apply struct_fields_split_intro.
  unfold_typed_pointsto; split_pointsto_app.

  rewrite -!/(typed_pointsto_def _ _ _) -!typed_pointsto_unseal.
  simpl_one_flatten_struct (# (Auditor.mu' v)) (auditor.Auditor) "mu"%go.
  simpl_one_flatten_struct (# (Auditor.sk' v)) (auditor.Auditor) "sk"%go.
  simpl_one_flatten_struct (# (Auditor.lastDig' v)) (auditor.Auditor) "lastDig"%go.
  simpl_one_flatten_struct (# (Auditor.startEp' v)) (auditor.Auditor) "startEp"%go.
  simpl_one_flatten_struct (# (Auditor.hist' v)) (auditor.Auditor) "hist"%go.

  solve_field_ref_f.
Qed.

End instances.

(* type auditor.history *)
Module history.
Section def.
Context `{ffi_syntax}.
Record t := mk {
  link' : slice.t;
  servSig' : slice.t;
  adtrSig' : slice.t;
}.
End def.
End history.

Section instances.
Context `{ffi_syntax}.
#[local] Transparent auditor.history.
#[local] Typeclasses Transparent auditor.history.

Global Instance history_wf : struct.Wf auditor.history.
Proof. apply _. Qed.

Global Instance settable_history : Settable history.t :=
  settable! history.mk < history.link'; history.servSig'; history.adtrSig' >.
Global Instance into_val_history : IntoVal history.t :=
  {| to_val_def v :=
    struct.val_aux auditor.history [
    "link" ::= #(history.link' v);
    "servSig" ::= #(history.servSig' v);
    "adtrSig" ::= #(history.adtrSig' v)
    ]%struct
  |}.

Global Program Instance into_val_typed_history : IntoValTyped history.t auditor.history :=
{|
  default_val := history.mk (default_val _) (default_val _) (default_val _);
|}.
Next Obligation. solve_to_val_type. Qed.
Next Obligation. solve_zero_val. Qed.
Next Obligation. solve_to_val_inj. Qed.
Final Obligation. solve_decision. Qed.

Global Instance into_val_struct_field_history_link : IntoValStructField "link" auditor.history history.link'.
Proof. solve_into_val_struct_field. Qed.

Global Instance into_val_struct_field_history_servSig : IntoValStructField "servSig" auditor.history history.servSig'.
Proof. solve_into_val_struct_field. Qed.

Global Instance into_val_struct_field_history_adtrSig : IntoValStructField "adtrSig" auditor.history history.adtrSig'.
Proof. solve_into_val_struct_field. Qed.


Context `{!ffi_model, !ffi_semantics _ _, !ffi_interp _, !heapGS Σ}.
Global Instance wp_struct_make_history link' servSig' adtrSig':
  PureWp True
    (struct.make #auditor.history (alist_val [
      "link" ::= #link';
      "servSig" ::= #servSig';
      "adtrSig" ::= #adtrSig'
    ]))%struct
    #(history.mk link' servSig' adtrSig').
Proof. solve_struct_make_pure_wp. Qed.


Global Instance history_struct_fields_split dq l (v : history.t) :
  StructFieldsSplit dq l v (
    "Hlink" ∷ l ↦s[auditor.history :: "link"]{dq} v.(history.link') ∗
    "HservSig" ∷ l ↦s[auditor.history :: "servSig"]{dq} v.(history.servSig') ∗
    "HadtrSig" ∷ l ↦s[auditor.history :: "adtrSig"]{dq} v.(history.adtrSig')
  ).
Proof.
  rewrite /named.
  apply struct_fields_split_intro.
  unfold_typed_pointsto; split_pointsto_app.

  rewrite -!/(typed_pointsto_def _ _ _) -!typed_pointsto_unseal.
  simpl_one_flatten_struct (# (history.link' v)) (auditor.history) "link"%go.
  simpl_one_flatten_struct (# (history.servSig' v)) (auditor.history) "servSig"%go.

  solve_field_ref_f.
Qed.

End instances.

(* type auditor.serv *)
Module serv.
Section def.
Context `{ffi_syntax}.
Record t := mk {
  cli' : loc;
  sigPk' : cryptoffi.SigPublicKey.t;
  vrfPk' : slice.t;
  servVrfSig' : slice.t;
  adtrVrfSig' : slice.t;
}.
End def.
End serv.

Section instances.
Context `{ffi_syntax}.
#[local] Transparent auditor.serv.
#[local] Typeclasses Transparent auditor.serv.

Global Instance serv_wf : struct.Wf auditor.serv.
Proof. apply _. Qed.

Global Instance settable_serv : Settable serv.t :=
  settable! serv.mk < serv.cli'; serv.sigPk'; serv.vrfPk'; serv.servVrfSig'; serv.adtrVrfSig' >.
Global Instance into_val_serv : IntoVal serv.t :=
  {| to_val_def v :=
    struct.val_aux auditor.serv [
    "cli" ::= #(serv.cli' v);
    "sigPk" ::= #(serv.sigPk' v);
    "vrfPk" ::= #(serv.vrfPk' v);
    "servVrfSig" ::= #(serv.servVrfSig' v);
    "adtrVrfSig" ::= #(serv.adtrVrfSig' v)
    ]%struct
  |}.

Global Program Instance into_val_typed_serv : IntoValTyped serv.t auditor.serv :=
{|
  default_val := serv.mk (default_val _) (default_val _) (default_val _) (default_val _) (default_val _);
|}.
Next Obligation. solve_to_val_type. Qed.
Next Obligation. solve_zero_val. Qed.
Next Obligation. solve_to_val_inj. Qed.
Final Obligation. solve_decision. Qed.

Global Instance into_val_struct_field_serv_cli : IntoValStructField "cli" auditor.serv serv.cli'.
Proof. solve_into_val_struct_field. Qed.

Global Instance into_val_struct_field_serv_sigPk : IntoValStructField "sigPk" auditor.serv serv.sigPk'.
Proof. solve_into_val_struct_field. Qed.

Global Instance into_val_struct_field_serv_vrfPk : IntoValStructField "vrfPk" auditor.serv serv.vrfPk'.
Proof. solve_into_val_struct_field. Qed.

Global Instance into_val_struct_field_serv_servVrfSig : IntoValStructField "servVrfSig" auditor.serv serv.servVrfSig'.
Proof. solve_into_val_struct_field. Qed.

Global Instance into_val_struct_field_serv_adtrVrfSig : IntoValStructField "adtrVrfSig" auditor.serv serv.adtrVrfSig'.
Proof. solve_into_val_struct_field. Qed.


Context `{!ffi_model, !ffi_semantics _ _, !ffi_interp _, !heapGS Σ}.
Global Instance wp_struct_make_serv cli' sigPk' vrfPk' servVrfSig' adtrVrfSig':
  PureWp True
    (struct.make #auditor.serv (alist_val [
      "cli" ::= #cli';
      "sigPk" ::= #sigPk';
      "vrfPk" ::= #vrfPk';
      "servVrfSig" ::= #servVrfSig';
      "adtrVrfSig" ::= #adtrVrfSig'
    ]))%struct
    #(serv.mk cli' sigPk' vrfPk' servVrfSig' adtrVrfSig').
Proof. solve_struct_make_pure_wp. Qed.


Global Instance serv_struct_fields_split dq l (v : serv.t) :
  StructFieldsSplit dq l v (
    "Hcli" ∷ l ↦s[auditor.serv :: "cli"]{dq} v.(serv.cli') ∗
    "HsigPk" ∷ l ↦s[auditor.serv :: "sigPk"]{dq} v.(serv.sigPk') ∗
    "HvrfPk" ∷ l ↦s[auditor.serv :: "vrfPk"]{dq} v.(serv.vrfPk') ∗
    "HservVrfSig" ∷ l ↦s[auditor.serv :: "servVrfSig"]{dq} v.(serv.servVrfSig') ∗
    "HadtrVrfSig" ∷ l ↦s[auditor.serv :: "adtrVrfSig"]{dq} v.(serv.adtrVrfSig')
  ).
Proof.
  rewrite /named.
  apply struct_fields_split_intro.
  unfold_typed_pointsto; split_pointsto_app.

  rewrite -!/(typed_pointsto_def _ _ _) -!typed_pointsto_unseal.
  simpl_one_flatten_struct (# (serv.cli' v)) (auditor.serv) "cli"%go.
  simpl_one_flatten_struct (# (serv.sigPk' v)) (auditor.serv) "sigPk"%go.
  simpl_one_flatten_struct (# (serv.vrfPk' v)) (auditor.serv) "vrfPk"%go.
  simpl_one_flatten_struct (# (serv.servVrfSig' v)) (auditor.serv) "servVrfSig"%go.

  solve_field_ref_f.
Qed.

End instances.

(* type auditor.GetArg *)
Module GetArg.
Section def.
Context `{ffi_syntax}.
Record t := mk {
  Epoch' : w64;
}.
End def.
End GetArg.

Section instances.
Context `{ffi_syntax}.
#[local] Transparent auditor.GetArg.
#[local] Typeclasses Transparent auditor.GetArg.

Global Instance GetArg_wf : struct.Wf auditor.GetArg.
Proof. apply _. Qed.

Global Instance settable_GetArg : Settable GetArg.t :=
  settable! GetArg.mk < GetArg.Epoch' >.
Global Instance into_val_GetArg : IntoVal GetArg.t :=
  {| to_val_def v :=
    struct.val_aux auditor.GetArg [
    "Epoch" ::= #(GetArg.Epoch' v)
    ]%struct
  |}.

Global Program Instance into_val_typed_GetArg : IntoValTyped GetArg.t auditor.GetArg :=
{|
  default_val := GetArg.mk (default_val _);
|}.
Next Obligation. solve_to_val_type. Qed.
Next Obligation. solve_zero_val. Qed.
Next Obligation. solve_to_val_inj. Qed.
Final Obligation. solve_decision. Qed.

Global Instance into_val_struct_field_GetArg_Epoch : IntoValStructField "Epoch" auditor.GetArg GetArg.Epoch'.
Proof. solve_into_val_struct_field. Qed.


Context `{!ffi_model, !ffi_semantics _ _, !ffi_interp _, !heapGS Σ}.
Global Instance wp_struct_make_GetArg Epoch':
  PureWp True
    (struct.make #auditor.GetArg (alist_val [
      "Epoch" ::= #Epoch'
    ]))%struct
    #(GetArg.mk Epoch').
Proof. solve_struct_make_pure_wp. Qed.


Global Instance GetArg_struct_fields_split dq l (v : GetArg.t) :
  StructFieldsSplit dq l v (
    "HEpoch" ∷ l ↦s[auditor.GetArg :: "Epoch"]{dq} v.(GetArg.Epoch')
  ).
Proof.
  rewrite /named.
  apply struct_fields_split_intro.
  unfold_typed_pointsto; split_pointsto_app.

  rewrite -!/(typed_pointsto_def _ _ _) -!typed_pointsto_unseal.

  solve_field_ref_f.
Qed.

End instances.

(* type auditor.SignedLink *)
Module SignedLink.
Section def.
Context `{ffi_syntax}.
Record t := mk {
  Link' : slice.t;
  ServSig' : slice.t;
  AdtrSig' : slice.t;
}.
End def.
End SignedLink.

Section instances.
Context `{ffi_syntax}.
#[local] Transparent auditor.SignedLink.
#[local] Typeclasses Transparent auditor.SignedLink.

Global Instance SignedLink_wf : struct.Wf auditor.SignedLink.
Proof. apply _. Qed.

Global Instance settable_SignedLink : Settable SignedLink.t :=
  settable! SignedLink.mk < SignedLink.Link'; SignedLink.ServSig'; SignedLink.AdtrSig' >.
Global Instance into_val_SignedLink : IntoVal SignedLink.t :=
  {| to_val_def v :=
    struct.val_aux auditor.SignedLink [
    "Link" ::= #(SignedLink.Link' v);
    "ServSig" ::= #(SignedLink.ServSig' v);
    "AdtrSig" ::= #(SignedLink.AdtrSig' v)
    ]%struct
  |}.

Global Program Instance into_val_typed_SignedLink : IntoValTyped SignedLink.t auditor.SignedLink :=
{|
  default_val := SignedLink.mk (default_val _) (default_val _) (default_val _);
|}.
Next Obligation. solve_to_val_type. Qed.
Next Obligation. solve_zero_val. Qed.
Next Obligation. solve_to_val_inj. Qed.
Final Obligation. solve_decision. Qed.

Global Instance into_val_struct_field_SignedLink_Link : IntoValStructField "Link" auditor.SignedLink SignedLink.Link'.
Proof. solve_into_val_struct_field. Qed.

Global Instance into_val_struct_field_SignedLink_ServSig : IntoValStructField "ServSig" auditor.SignedLink SignedLink.ServSig'.
Proof. solve_into_val_struct_field. Qed.

Global Instance into_val_struct_field_SignedLink_AdtrSig : IntoValStructField "AdtrSig" auditor.SignedLink SignedLink.AdtrSig'.
Proof. solve_into_val_struct_field. Qed.


Context `{!ffi_model, !ffi_semantics _ _, !ffi_interp _, !heapGS Σ}.
Global Instance wp_struct_make_SignedLink Link' ServSig' AdtrSig':
  PureWp True
    (struct.make #auditor.SignedLink (alist_val [
      "Link" ::= #Link';
      "ServSig" ::= #ServSig';
      "AdtrSig" ::= #AdtrSig'
    ]))%struct
    #(SignedLink.mk Link' ServSig' AdtrSig').
Proof. solve_struct_make_pure_wp. Qed.


Global Instance SignedLink_struct_fields_split dq l (v : SignedLink.t) :
  StructFieldsSplit dq l v (
    "HLink" ∷ l ↦s[auditor.SignedLink :: "Link"]{dq} v.(SignedLink.Link') ∗
    "HServSig" ∷ l ↦s[auditor.SignedLink :: "ServSig"]{dq} v.(SignedLink.ServSig') ∗
    "HAdtrSig" ∷ l ↦s[auditor.SignedLink :: "AdtrSig"]{dq} v.(SignedLink.AdtrSig')
  ).
Proof.
  rewrite /named.
  apply struct_fields_split_intro.
  unfold_typed_pointsto; split_pointsto_app.

  rewrite -!/(typed_pointsto_def _ _ _) -!typed_pointsto_unseal.
  simpl_one_flatten_struct (# (SignedLink.Link' v)) (auditor.SignedLink) "Link"%go.
  simpl_one_flatten_struct (# (SignedLink.ServSig' v)) (auditor.SignedLink) "ServSig"%go.

  solve_field_ref_f.
Qed.

End instances.

(* type auditor.SignedVrf *)
Module SignedVrf.
Section def.
Context `{ffi_syntax}.
Record t := mk {
  VrfPk' : slice.t;
  ServSig' : slice.t;
  AdtrSig' : slice.t;
}.
End def.
End SignedVrf.

Section instances.
Context `{ffi_syntax}.
#[local] Transparent auditor.SignedVrf.
#[local] Typeclasses Transparent auditor.SignedVrf.

Global Instance SignedVrf_wf : struct.Wf auditor.SignedVrf.
Proof. apply _. Qed.

Global Instance settable_SignedVrf : Settable SignedVrf.t :=
  settable! SignedVrf.mk < SignedVrf.VrfPk'; SignedVrf.ServSig'; SignedVrf.AdtrSig' >.
Global Instance into_val_SignedVrf : IntoVal SignedVrf.t :=
  {| to_val_def v :=
    struct.val_aux auditor.SignedVrf [
    "VrfPk" ::= #(SignedVrf.VrfPk' v);
    "ServSig" ::= #(SignedVrf.ServSig' v);
    "AdtrSig" ::= #(SignedVrf.AdtrSig' v)
    ]%struct
  |}.

Global Program Instance into_val_typed_SignedVrf : IntoValTyped SignedVrf.t auditor.SignedVrf :=
{|
  default_val := SignedVrf.mk (default_val _) (default_val _) (default_val _);
|}.
Next Obligation. solve_to_val_type. Qed.
Next Obligation. solve_zero_val. Qed.
Next Obligation. solve_to_val_inj. Qed.
Final Obligation. solve_decision. Qed.

Global Instance into_val_struct_field_SignedVrf_VrfPk : IntoValStructField "VrfPk" auditor.SignedVrf SignedVrf.VrfPk'.
Proof. solve_into_val_struct_field. Qed.

Global Instance into_val_struct_field_SignedVrf_ServSig : IntoValStructField "ServSig" auditor.SignedVrf SignedVrf.ServSig'.
Proof. solve_into_val_struct_field. Qed.

Global Instance into_val_struct_field_SignedVrf_AdtrSig : IntoValStructField "AdtrSig" auditor.SignedVrf SignedVrf.AdtrSig'.
Proof. solve_into_val_struct_field. Qed.


Context `{!ffi_model, !ffi_semantics _ _, !ffi_interp _, !heapGS Σ}.
Global Instance wp_struct_make_SignedVrf VrfPk' ServSig' AdtrSig':
  PureWp True
    (struct.make #auditor.SignedVrf (alist_val [
      "VrfPk" ::= #VrfPk';
      "ServSig" ::= #ServSig';
      "AdtrSig" ::= #AdtrSig'
    ]))%struct
    #(SignedVrf.mk VrfPk' ServSig' AdtrSig').
Proof. solve_struct_make_pure_wp. Qed.


Global Instance SignedVrf_struct_fields_split dq l (v : SignedVrf.t) :
  StructFieldsSplit dq l v (
    "HVrfPk" ∷ l ↦s[auditor.SignedVrf :: "VrfPk"]{dq} v.(SignedVrf.VrfPk') ∗
    "HServSig" ∷ l ↦s[auditor.SignedVrf :: "ServSig"]{dq} v.(SignedVrf.ServSig') ∗
    "HAdtrSig" ∷ l ↦s[auditor.SignedVrf :: "AdtrSig"]{dq} v.(SignedVrf.AdtrSig')
  ).
Proof.
  rewrite /named.
  apply struct_fields_split_intro.
  unfold_typed_pointsto; split_pointsto_app.

  rewrite -!/(typed_pointsto_def _ _ _) -!typed_pointsto_unseal.
  simpl_one_flatten_struct (# (SignedVrf.VrfPk' v)) (auditor.SignedVrf) "VrfPk"%go.
  simpl_one_flatten_struct (# (SignedVrf.ServSig' v)) (auditor.SignedVrf) "ServSig"%go.

  solve_field_ref_f.
Qed.

End instances.

(* type auditor.GetReply *)
Module GetReply.
Section def.
Context `{ffi_syntax}.
Record t := mk {
  Link' : loc;
  Vrf' : loc;
  Err' : bool;
}.
End def.
End GetReply.

Section instances.
Context `{ffi_syntax}.
#[local] Transparent auditor.GetReply.
#[local] Typeclasses Transparent auditor.GetReply.

Global Instance GetReply_wf : struct.Wf auditor.GetReply.
Proof. apply _. Qed.

Global Instance settable_GetReply : Settable GetReply.t :=
  settable! GetReply.mk < GetReply.Link'; GetReply.Vrf'; GetReply.Err' >.
Global Instance into_val_GetReply : IntoVal GetReply.t :=
  {| to_val_def v :=
    struct.val_aux auditor.GetReply [
    "Link" ::= #(GetReply.Link' v);
    "Vrf" ::= #(GetReply.Vrf' v);
    "Err" ::= #(GetReply.Err' v)
    ]%struct
  |}.

Global Program Instance into_val_typed_GetReply : IntoValTyped GetReply.t auditor.GetReply :=
{|
  default_val := GetReply.mk (default_val _) (default_val _) (default_val _);
|}.
Next Obligation. solve_to_val_type. Qed.
Next Obligation. solve_zero_val. Qed.
Next Obligation. solve_to_val_inj. Qed.
Final Obligation. solve_decision. Qed.

Global Instance into_val_struct_field_GetReply_Link : IntoValStructField "Link" auditor.GetReply GetReply.Link'.
Proof. solve_into_val_struct_field. Qed.

Global Instance into_val_struct_field_GetReply_Vrf : IntoValStructField "Vrf" auditor.GetReply GetReply.Vrf'.
Proof. solve_into_val_struct_field. Qed.

Global Instance into_val_struct_field_GetReply_Err : IntoValStructField "Err" auditor.GetReply GetReply.Err'.
Proof. solve_into_val_struct_field. Qed.


Context `{!ffi_model, !ffi_semantics _ _, !ffi_interp _, !heapGS Σ}.
Global Instance wp_struct_make_GetReply Link' Vrf' Err':
  PureWp True
    (struct.make #auditor.GetReply (alist_val [
      "Link" ::= #Link';
      "Vrf" ::= #Vrf';
      "Err" ::= #Err'
    ]))%struct
    #(GetReply.mk Link' Vrf' Err').
Proof. solve_struct_make_pure_wp. Qed.


Global Instance GetReply_struct_fields_split dq l (v : GetReply.t) :
  StructFieldsSplit dq l v (
    "HLink" ∷ l ↦s[auditor.GetReply :: "Link"]{dq} v.(GetReply.Link') ∗
    "HVrf" ∷ l ↦s[auditor.GetReply :: "Vrf"]{dq} v.(GetReply.Vrf') ∗
    "HErr" ∷ l ↦s[auditor.GetReply :: "Err"]{dq} v.(GetReply.Err')
  ).
Proof.
  rewrite /named.
  apply struct_fields_split_intro.
  unfold_typed_pointsto; split_pointsto_app.

  rewrite -!/(typed_pointsto_def _ _ _) -!typed_pointsto_unseal.
  simpl_one_flatten_struct (# (GetReply.Link' v)) (auditor.GetReply) "Link"%go.
  simpl_one_flatten_struct (# (GetReply.Vrf' v)) (auditor.GetReply) "Vrf"%go.

  solve_field_ref_f.
Qed.

End instances.

Section names.

Context `{hG: heapGS Σ, !ffi_semantics _ _}.
Context `{!globalsGS Σ}.
Context {go_ctx : GoContext}.
#[local] Transparent is_pkg_defined is_pkg_defined_pure.

Global Instance is_pkg_defined_pure_auditor : IsPkgDefinedPure auditor :=
  {|
    is_pkg_defined_pure_def go_ctx :=
      is_pkg_defined_pure_single auditor ∧
      is_pkg_defined_pure code.bytes.bytes ∧
      is_pkg_defined_pure code.sync.sync ∧
      is_pkg_defined_pure code.github_com.goose_lang.std.std ∧
      is_pkg_defined_pure code.github_com.sanjit_bhat.pav.advrpc.advrpc ∧
      is_pkg_defined_pure code.github_com.sanjit_bhat.pav.cryptoffi.cryptoffi ∧
      is_pkg_defined_pure code.github_com.sanjit_bhat.pav.hashchain.hashchain ∧
      is_pkg_defined_pure code.github_com.sanjit_bhat.pav.ktcore.ktcore ∧
      is_pkg_defined_pure code.github_com.sanjit_bhat.pav.merkle.merkle ∧
      is_pkg_defined_pure code.github_com.sanjit_bhat.pav.server.server ∧
      is_pkg_defined_pure code.github_com.sanjit_bhat.pav.safemarshal.safemarshal ∧
      is_pkg_defined_pure code.github_com.tchajed.marshal.marshal;
  |}.

#[local] Transparent is_pkg_defined_single is_pkg_defined_pure_single.
Global Program Instance is_pkg_defined_auditor : IsPkgDefined auditor :=
  {|
    is_pkg_defined_def go_ctx :=
      (is_pkg_defined_single auditor ∗
       is_pkg_defined code.bytes.bytes ∗
       is_pkg_defined code.sync.sync ∗
       is_pkg_defined code.github_com.goose_lang.std.std ∗
       is_pkg_defined code.github_com.sanjit_bhat.pav.advrpc.advrpc ∗
       is_pkg_defined code.github_com.sanjit_bhat.pav.cryptoffi.cryptoffi ∗
       is_pkg_defined code.github_com.sanjit_bhat.pav.hashchain.hashchain ∗
       is_pkg_defined code.github_com.sanjit_bhat.pav.ktcore.ktcore ∗
       is_pkg_defined code.github_com.sanjit_bhat.pav.merkle.merkle ∗
       is_pkg_defined code.github_com.sanjit_bhat.pav.server.server ∗
       is_pkg_defined code.github_com.sanjit_bhat.pav.safemarshal.safemarshal ∗
       is_pkg_defined code.github_com.tchajed.marshal.marshal)%I
  |}.
Final Obligation. iIntros. iFrame "#%". Qed.
#[local] Opaque is_pkg_defined_single is_pkg_defined_pure_single.

Global Instance wp_func_call_New :
  WpFuncCall auditor.New _ (is_pkg_defined auditor) :=
  ltac:(solve_wp_func_call).

Global Instance wp_func_call_getNextLink :
  WpFuncCall auditor.getNextLink _ (is_pkg_defined auditor) :=
  ltac:(solve_wp_func_call).

Global Instance wp_func_call_getNextDig :
  WpFuncCall auditor.getNextDig _ (is_pkg_defined auditor) :=
  ltac:(solve_wp_func_call).

Global Instance wp_func_call_CheckStartChain :
  WpFuncCall auditor.CheckStartChain _ (is_pkg_defined auditor) :=
  ltac:(solve_wp_func_call).

Global Instance wp_func_call_CheckStartVrf :
  WpFuncCall auditor.CheckStartVrf _ (is_pkg_defined auditor) :=
  ltac:(solve_wp_func_call).

Global Instance wp_func_call_NewRpcAuditor :
  WpFuncCall auditor.NewRpcAuditor _ (is_pkg_defined auditor) :=
  ltac:(solve_wp_func_call).

Global Instance wp_func_call_CallGet :
  WpFuncCall auditor.CallGet _ (is_pkg_defined auditor) :=
  ltac:(solve_wp_func_call).

Global Instance wp_func_call_GetArgEncode :
  WpFuncCall auditor.GetArgEncode _ (is_pkg_defined auditor) :=
  ltac:(solve_wp_func_call).

Global Instance wp_func_call_GetArgDecode :
  WpFuncCall auditor.GetArgDecode _ (is_pkg_defined auditor) :=
  ltac:(solve_wp_func_call).

Global Instance wp_func_call_SignedLinkEncode :
  WpFuncCall auditor.SignedLinkEncode _ (is_pkg_defined auditor) :=
  ltac:(solve_wp_func_call).

Global Instance wp_func_call_SignedLinkDecode :
  WpFuncCall auditor.SignedLinkDecode _ (is_pkg_defined auditor) :=
  ltac:(solve_wp_func_call).

Global Instance wp_func_call_SignedVrfEncode :
  WpFuncCall auditor.SignedVrfEncode _ (is_pkg_defined auditor) :=
  ltac:(solve_wp_func_call).

Global Instance wp_func_call_SignedVrfDecode :
  WpFuncCall auditor.SignedVrfDecode _ (is_pkg_defined auditor) :=
  ltac:(solve_wp_func_call).

Global Instance wp_func_call_GetReplyEncode :
  WpFuncCall auditor.GetReplyEncode _ (is_pkg_defined auditor) :=
  ltac:(solve_wp_func_call).

Global Instance wp_func_call_GetReplyDecode :
  WpFuncCall auditor.GetReplyDecode _ (is_pkg_defined auditor) :=
  ltac:(solve_wp_func_call).

Global Instance wp_method_call_Auditor'ptr_Get :
  WpMethodCall (ptrT.id auditor.Auditor.id) "Get" _ (is_pkg_defined auditor) :=
  ltac:(solve_wp_method_call).

Global Instance wp_method_call_Auditor'ptr_Update :
  WpMethodCall (ptrT.id auditor.Auditor.id) "Update" _ (is_pkg_defined auditor) :=
  ltac:(solve_wp_method_call).

End names.
End auditor.
